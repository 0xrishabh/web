{% extends 'quadraticlands/components/base.html' %}
{% load humanize static i18n %}
{% block 'content' %}
	<section class="column">
		<p>web3</p>
	</section>
{% endblock %}
{% block 'scripts' %}
	<!--some custom particles-->
	<script src="/static/quadraticlands/js/particles.js"></script>
	<!--Scroll Animation Library (sal) INIT-->
	<script src="/static/quadraticlands/js/sal_init.js"></script>
	<!--APP - burger menu, wallet menu, provider select-->
	<script src="/static/quadraticlands/js/app.js"></script>
	<!-- this page NEEDS a Wallet and will force the Web3Modal -->
	<script src="/static/quadraticlands/js/forceWallet.js"></script>
	<!-- ABIs -->
    <script src="{% static "v2/js/abi.js" %}"></script>
	<script>
		function web3Ready() {
		  console.debug('WEB3 version from script', web3.version);
		  // some examples of getting data from the GTC and tokenDist contracts 
		  // get token balance - using generic ERC20 function from Octos wallet file
		  getTokenBalances(gtc_address()).then(function(result) {
				 console.debug('ERC20 TokenBalance:', result.balance);
		  });

		  // get current votes 
		  getCurrentVotez(gtc_address()).then(function(result) { 
			  console.debug('Current GTC Votes:', result);
		  });
		}
	    document.addEventListener("dataWalletReady", web3Ready);
	</script>

    <script>
		/**
		*  * Gets the current votes balance for an address from GTC Token contract.
		*  * @param {string} tokenAddress - the ERC20 token address
		*  */
		async function getCurrentVotez(tokenAddress) {
		
		// Get GTC Token contract instance
		let GTCContract = new web3.eth.Contract(gtc_token_abi, tokenAddress);
		
		// Call getCurrentVotes function
		current_votes = GTCContract.methods.getCurrentVotes(selectedAccount).call({from: selectedAccount})
		return current_votes;

		}
	</script>


{% endblock %}