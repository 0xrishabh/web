{% comment %}
  Copyright (C) 2020 Gitcoin Core

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published
  by the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program. If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}

{% load static humanize i18n grants_extra %}

<!DOCTYPE html>
<html lang="en">

  <head>
    {% include 'shared/head.html' with slim=1 %}
    {% include 'shared/cards.html' %}
    <link rel="stylesheet" href="https://unpkg.com/vue-select@latest/dist/vue-select.css">
    <link rel="stylesheet" href="{% static "v2/css/grants/new.css" %}">
    <link rel="stylesheet" href={% static "v2/css/tabs.css" %}>

    <script src="//cdn.quilljs.com/1.3.6/quill.core.js"></script>
    <link href="//cdn.quilljs.com/1.3.6/quill.bubble.css" rel="stylesheet">
    <link href="//cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <link rel="prefetch" href="/grants/v1/api/grant/{{grant.id}}/" />


  </head>

  <body class="interior {{ active }} grant g-font-muli">
    {% include 'shared/tag_manager_2.html' %}
    <div class="container-fluid header dash px-0">
      {% include 'shared/top_nav.html' with class='d-md-flex' %}
      {% include 'grants/nav.html' %}
    </div>
    {% if is_staff %}
      <div class="alpha-warning font-caption mb-0">
        <span class="font-weight-bold">Staff only</span>
        <a style="color:white;" href="{{grant.admin_url}}">{% trans "View Admin" %}</a>
      </div>
    {% endif %}
    <div class="container-fluid bg-lightblue pb-5" id="gc-grant-detail"  v-cloak>
      <!-- sdf {{grant}} -->
      <img :src="grant.logo_url" alt="" height="290px" class="m-auto d-block">

      <div class="row">
        <div class="container">
          <div class="d-flex">
            <h1>
              [[grant.title]]
            </h1>
            <span class="">Updated: [[grant.last_update]]</span>
          </div>
          <template v-if="grant.tenants && grant.tenants.indexOf('ETH') > -1">
            <i class="fab fa-ethereum"></i> [[grant.admin_address]]

            <a target="_blank" :href="`https://etherscan.io/address/${grant.admin_address}`" class="col-auto" id="wallet-etherscan-link">View on Etherscan (L1) <i class="ml-1 fas fa-external-link-alt"></i></a>
            <a target="_blank" :href="`https://zkscan.io/explorer/accounts/${grant.admin_address}`" class="col-auto" id="wallet-zkscan-link">View on zkScan (L2) <i class="ml-1 fas fa-external-link-alt"></i></a>
          </template>
          <template v-else-if="grant.tenants && grant.tenants.indexOf('ZCASH') > -1">
            <div class="mb-2">
              <img class="mr-2" src="{% static 'v2/images/chains/zcash.svg' %}" alt="" width="16">
              <a target="_blank" :href="`https://sochain.com/address/ZEC/${grant.zcash_payout_address}`">
                <span id="z-cash-address" class="wallet-address"
                  target="_blank" data-toggle="tooltip" data-placement="top" title="Project Zcash Funding Address">
                  [[grant.zcash_payout_address]]
                </span>
              </a>
            </div>
          </template>


          <span>
            <i class="fab fa-twitter-square mr-2"></i> <a target="_blank" :href="`https://twitter.com/${grant.twitter_handle_1}`">@[[grant.twitter_handle_1]]</a>
            <span v-if="grant.verified" class="py-0 position-relative px-0 btn btn-sm animate-verify" data-container="body" data-toggle="popover" data-html="true" data-placement="bottom" data-trigger="hover click" data-content='
              <p class="h6 my-2 text-left">
                Verified Ownership
                <img width="18" src="{% static "v2/images/badge-verify.svg" %}">
              </p>
              <p>Grant owner has verified ownership of their twitter account.</p>
              <a href="#">Learn more.</p>'
            >
              <img width="13" src="{% static 'v2/images/badge-verify.svg' %}" alt="">
            </span>
          </span>

          <div v-if="grant.github_project_url">
            <i class="fab fa-github"></i> <a :href="grant.github_project_url">[[grant.github_project_url]]</a>
          </div>
          <div>
            <i class="fas fa-link"></i> <a :href="grant.reference_url">[[grant.reference_url]]</a>
          </div>
          <div v-for="member in grant.team_members" :key="member.pk">
            <b-img-lazy class="rounded-circle bg-white" width="40" height="40" :src="`/dynamic/avatar/${member.fields.handle}`" alt="Image 1"></b-img-lazy>
            [[member.fields.handle]]
          </div>
          <div>
            [[grant.description]]
          </div>
          [[grant.isInCart]]

          <button @click="removeFromCart()" v-if="grant.isInCart">removeFromCart</button>
          <button @click="addToCart()" v-else >Add</button>

        </div>
      </div>

    </div>
    {% include 'shared/bottom_notification.html' %}
    {% include 'shared/footer.html' %}
    {% include 'shared/current_profile.html' %}
    {% include 'shared/analytics.html' %}
    {% include 'grants/shared/shared_scripts.html' %}
    {% include 'shared/footer_scripts.html' with vue=True ignore_inject_web3=1 %}
    <script>
      var grantDetails = {
                 grant_id: "{{ grant.id }}",
                 grant_slug: "{{ grant.slug }}",
                 grant_url: "{{ grant.url }}",
                 grant_title: "{{ grant.title }}",
                 grant_contract_version: "{{ grant.contract_version }}",
                 grant_contract_address: "{{ grant.contract_address }}",
                 grant_token_symbol: "{{ grant.token_symbol }}",
                 grant_admin_address: "{{ grant.admin_address }}",
                 zcash_payout_address: "{{ grant.zcash_payout_address }}",
                 grant_token_address: "{{ grant.token_address }}",
                 grant_logo: {% if grant.logo and grant.logo.url %}"{{ grant.logo.url }}"{% else %}{% with grant_logo='v2/images/grants/logos/' id=grant.id|modulo:3 %} "{% static grant_logo|addstr:id|add:'.png' %}" {% endwith %} {% endif %},
                 grant_clr_prediction_curve: "{{ grant.clr_prediction_curve }}",
                 grant_image_css: "{{ grant.image_css }}",
                 tenants: {{ grant.tenants |safe }},
                 is_clr_eligible: {{grant.is_clr_eligible|yesno:"true,false"}},
                 grant_donation_amount: "{{ amount }}",
                 grant_donation_currency: "{{ token.symbol }}",
                 token_local_id: "{{ token.id }}"
               };

   </script>
    {% include 'shared/activity_scripts.html' %}

    <script src="{% static "v2/js/grants/_detail.js" %}"></script>


  </body>
